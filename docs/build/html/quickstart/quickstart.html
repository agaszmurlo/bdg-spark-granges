

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1   Quickstart &mdash; bdg-sequila 0.3-SNAPSHOT documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="bdg-sequila 0.3-SNAPSHOT documentation" href="../index.html"/>
        <link rel="next" title="2   Overview" href="../overview/overview.html"/>
        <link rel="prev" title="SeQuiLa documentation" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> bdg-sequila
          

          
            
            <img src="../_static/sequila.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.3-SNAPSHOT
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1&nbsp;&nbsp;&nbsp;Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#test-run-at-local-machine">1.1&nbsp;&nbsp;&nbsp;Test run at local machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="#launch-bdg-shell">1.2&nbsp;&nbsp;&nbsp;Launch bdg-shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="#launch-spark-shell">1.3&nbsp;&nbsp;&nbsp;Launch spark-shell</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/overview.html">2&nbsp;&nbsp;&nbsp;Overview</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage/usage.html">3&nbsp;&nbsp;&nbsp;Usage</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../function/function.html">4&nbsp;&nbsp;&nbsp;SeQuiLa API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usecases/usecases.html">5&nbsp;&nbsp;&nbsp;Usecases</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../citation/citation.html">6&nbsp;&nbsp;&nbsp;License and citation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">bdg-sequila</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>1&nbsp;&nbsp;&nbsp;Quickstart</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/quickstart/quickstart.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <a href="https://github.com/ZSI-Bio/bdg-sequila"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a><blockquote>
<div></div></blockquote>
<div class="section" id="quickstart">
<h1>1&nbsp;&nbsp;&nbsp;Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this headline">¶</a></h1>
<p>SeQuiLa is perfect for quick, ad-hoc analysis. Get ready for quickstart with SeQuiLa.</p>
<p>First we will verify installation of SeQuiLa.</p>
<div class="section" id="test-run-at-local-machine">
<h2>1.1&nbsp;&nbsp;&nbsp;Test run at local machine<a class="headerlink" href="#test-run-at-local-machine" title="Permalink to this headline">¶</a></h2>
<p>Sequila is distributed as Docker image. It is available at DockerHub.</p>
<p>The quickest way to test sequila is to run test example on sample data which are already packaged in docker container.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Prerequisities: You should have docker daemon installed and running. <a class="reference external" href="https://docs.docker.com/install/">https://docs.docker.com/install/</a></p>
</div>
<p>In your command line pull docker image from Docker Hub and invoke smoketests</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>docker pull biodatageeks/bdg-sequila

docker run -e <span class="nv">USERID</span><span class="o">=</span><span class="nv">$UID</span> -e <span class="nv">GROUPID</span><span class="o">=</span><span class="k">$(</span>id -g<span class="k">)</span> <span class="se">\</span>
  biodatageeks/bdg-sequila <span class="se">\</span>
  bdg-shell -i /tmp/smoketest.scala
</pre></div>
</div>
<p>This will open bdg-shell (wrapper for spark-shell) and load <code class="docutils literal"><span class="pre">smoketest.scala</span></code> code for execution. Since all test data are already packaged and accessible within the container you may just wait for results. Which won’t take too long. (Estimated time ~ 1 minute)</p>
<p>At the end you should see the following output:</p>
<img alt="../_images/quick_start_check.png" src="../_images/quick_start_check.png" />
<p>From the screenshot above you can see that our optimized IntervalTree-based join strategy was used. Some additional debug information were logged to the console.</p>
<p>The final result should be as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">TEST</span> <span class="n">PASSED</span>
</pre></div>
</div>
<p>Congratulations! Your installation is working on sample data.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are wondering what this part <code class="docutils literal"><span class="pre">-e</span> <span class="pre">USERID=$UID</span> <span class="pre">-e</span> <span class="pre">GROUPID=$(id</span> <span class="pre">-g)</span></code>  is for: It allows the docker container’s inside-user to write in mounted volumes with host’s user id and group id.</p>
</div>
</div>
<div class="section" id="launch-bdg-shell">
<h2>1.2&nbsp;&nbsp;&nbsp;Launch bdg-shell<a class="headerlink" href="#launch-bdg-shell" title="Permalink to this headline">¶</a></h2>
<p>Here we will launch bdg-shell which is actually spark-shell wrapped by biodatageeks with some additional configuration. So if you are familiar with Scala you will be able to use SeQuiLa right away.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>docker run -e <span class="nv">USERID</span><span class="o">=</span><span class="nv">$UID</span> -e <span class="nv">GROUPID</span><span class="o">=</span><span class="k">$(</span>id -g<span class="k">)</span> <span class="se">\</span>
     -it --rm <span class="se">\</span>
  biodatageeks/bdg-sequila <span class="se">\</span>
  bdg-shell
</pre></div>
</div>
<p>And voila you should see bdg-shell collecting its depenedencies and starting off. Now you are ready to load your sample data and do some interval queries playing on your own.</p>
</div>
<div class="section" id="launch-spark-shell">
<h2>1.3&nbsp;&nbsp;&nbsp;Launch spark-shell<a class="headerlink" href="#launch-spark-shell" title="Permalink to this headline">¶</a></h2>
<p>If for any reason you do not want to use bdg-shell and prefer pure spark-shell you can of course do that. But to use SeQuiLa’s efficient interval queries you have to configure it appropriately.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>docker run -e <span class="nv">USERID</span><span class="o">=</span><span class="nv">$UID</span> -e <span class="nv">GROUPID</span><span class="o">=</span><span class="k">$(</span>id -g<span class="k">)</span> <span class="se">\</span>
     -it --rm <span class="se">\</span>
  biodatageeks/bdg-sequila <span class="se">\</span>
  spark-shell --packages org.biodatageeks:bdg-sequila_2.11:<span class="si">${</span><span class="nv">BGD_VERSION</span><span class="si">}</span> <span class="se">\</span>
             --conf spark.sql.warehouse.dir<span class="o">=</span>/home/bdgeek/spark-warehouse <span class="se">\</span>
             --repositories https://zsibio.ii.pw.edu.pl/nexus/repository/maven-releases/,https://zsibio.ii.pw.edu.pl/nexus/repository/maven-snapshots/
</pre></div>
</div>
<p>And inside the shell:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">org.biodatageeks.utils.</span><span class="o">{</span><span class="nc">SequilaRegister</span><span class="o">,</span> <span class="nc">UDFRegister</span><span class="o">}</span>

<span class="cm">/*set params*/</span>

<span class="n">spark</span><span class="o">.</span><span class="n">sqlContext</span><span class="o">.</span><span class="n">setConf</span><span class="o">(</span><span class="s">&quot;spark.biodatageeks.rangejoin.useJoinOrder&quot;</span><span class="o">,</span><span class="s">&quot;false&quot;</span><span class="o">)</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sqlContext</span><span class="o">.</span><span class="n">setConf</span><span class="o">(</span><span class="s">&quot;spark.biodatageeks.rangejoin.maxBroadcastSize&quot;</span><span class="o">,</span> <span class="o">(</span><span class="mi">128</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="o">).</span><span class="n">toString</span><span class="o">)</span>

<span class="n">spark</span><span class="o">.</span><span class="n">sqlContext</span><span class="o">.</span><span class="n">setConf</span><span class="o">(</span><span class="s">&quot;spark.biodatageeks.rangejoin.minOverlap&quot;</span><span class="o">,</span><span class="s">&quot;1&quot;</span><span class="o">)</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sqlContext</span><span class="o">.</span><span class="n">setConf</span><span class="o">(</span><span class="s">&quot;spark.biodatageeks.rangejoin.maxGap&quot;</span><span class="o">,</span><span class="s">&quot;0&quot;</span><span class="o">)</span>

<span class="cm">/*register UDFs*/</span>

<span class="nc">UDFRegister</span><span class="o">.</span><span class="n">register</span><span class="o">(</span><span class="n">spark</span><span class="o">)</span>

<span class="cm">/*inject bdg-granges strategy*/</span>
<span class="nc">SequilaRegister</span><span class="o">.</span><span class="n">register</span><span class="o">(</span><span class="n">spark</span><span class="o">)</span>
</pre></div>
</div>
<p>It seems like there is a lot of configuration required - therefore we recommend using bdg-shell instead.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There are many other ways of how you can use SeQuiLa. Please refer to <a class="reference internal" href="../usage/usage.html"><span class="doc">3&nbsp;&nbsp;&nbsp;Usage</span></a></p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../overview/overview.html" class="btn btn-neutral float-right" title="2   Overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral" title="SeQuiLa documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, biodatageeks.org.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.3-SNAPSHOT',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>